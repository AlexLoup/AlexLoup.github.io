<!doctype html>
<html ng-app>
  <head>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.8/angular.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script>

    function shuffle(pool){
      //function source: https://www.w3resource.com/javascript-exercises/javascript-array-exercise-17.php
      var ctr = pool.length, temp, index;
      while (ctr > 0) {
        index = Math.floor(Math.random() * ctr);
        ctr--;
        temp = pool[ctr];
        pool[ctr] = pool[index];
        pool[index] = temp;
      }
      return pool;
    }

    function randomize(){
      var shuffleCount = 0;
      var pool = ["Greg", "Sara", "Michael", "Orrin", "Alex", "Tom", "Allison", "Keith"];
      do {
        pool = shuffle(pool);
        $("#p").html("");

        $("#p").append("<h1>Greg will buy for " + pool[0] + "</h1>");
        $("#p").append("<h1>Sara will buy for " + pool[1] + "</h1>");
        $("#p").append("<h1>Orrin will buy for " + pool[2] + "</h1>");
        $("#p").append("<h1>Alex will buy for " + pool[3] + "</h1>");
        $("#p").append("<h1>Michael will buy for " + pool[4] + "</h1>");
        $("#p").append("<h1>Allison will buy for " + pool[5] + "</h1>");
        $("#p").append("<h1>Tom will buy for " + pool[6] + "</h1>");
        $("#p").append("<h1>Keith will buy for " + pool[7] + "</h1>");
        shuffleCount += 1;
        console.log("Total shuffles: " + shuffleCount);
      } while (!valid(pool));
      $("#p").append("<h1>It took "+shuffleCount+" shuffles to get a valid list.</h1>");

    }


    function valid(list){
      var giver = ["Greg", "Sara", "Orrin", "Alex", "Michael", "Allison", "Tom", "Keith"];
      if (list[1] == "Orrin"
      || list[2] == "Sara"
      || list[3] == "Michael"
      || list[4] == "Alex"
      || list[5] == "Tom"
      || list[6] == "Allison"
        ) {
          console.log("INVALID LIST! Partner Match");
          return false;
        }
      for (i=0; i<list.length; i++){
        if (giver[i] == list[i]) {
          console.log("INVALID LIST! Self giving");
          return false;
        }
      }
      return true;
    }
    </script>
  </head>
  <body>
    <div>
      <div id="box">
      <p id="p">
      </p>
    </div>
      <button onclick="randomize()" type="button" class="btn btn-lg btn-block" style="font-size: 44px;">
        Randomize
      </button>
    </div>
  </body>
</html>
